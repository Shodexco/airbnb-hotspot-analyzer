========================================================================
AIRBNB PRICE HOTSPOT ANALYZER
========================================================================
========================================================================
FETCHING LISTINGS FOR NEW YORK CITY (nyc)
========================================================================
Trying snapshot: 2025-09-01
  OK - loaded 36,178 listings from 2025-09-01
========================================================================
STEP 1 - DATA PREPARATION
========================================================================
Converting price column to numeric dollars.
Cleaned listings: 36,178 -> 21,012
Price range: 10 - 5000 dollars per night
Median price: 150 dollars per night
========================================================================
STEP 2 - LANDMARK PROXIMITY
========================================================================
Computing distance in meters to nearest landmark (this can take a while).
Price by distance bucket (mean / median / count):
                    mean  median  count
distance_cat                           
<2km          363.982732   253.0   5154
2-5km         290.144129   198.0   4718
5-10km        155.431717   114.0   5814
>10km         134.800976   100.0   5326
========================================================================
STEP 3 - PREMIUM HOTSPOT DETECTION
========================================================================
Premium band: 200 - 1000 dollars per night.
Premium listings: 7,409 (35.3 percent of total)
Premium: DBSCAN finished. Clusters found (excluding noise): 39
Top premium clusters (by average price):
    cluster_id  listing_count   avg_price
38          38              9  701.888889
32          32             19  523.315789
0            0           4009  417.567473
27          27              4  410.500000
9            9             12  407.750000
========================================================================
STEP 3B - LUXURY HOTSPOT DETECTION
========================================================================
Luxury band: 1000 - 2500 dollars per night.
Luxury listings: 305 (1.5 percent of total)
Luxury: DBSCAN finished. Clusters found (excluding noise): 10
Top luxury clusters (by average price):
   cluster_id  listing_count    avg_price
8           8             10  1596.600000
5           5              8  1487.250000
0           0             10  1451.300000
1           1             61  1401.360656
7           7             21  1399.952381
========================================================================
STEP 3C - ULTRA LUXURY HOTSPOT DETECTION
========================================================================
Ultra Luxury band: 2500 - 5001 dollars per night.
Ultra Luxury listings: 58 (0.3 percent of total)
Ultra Luxury: DBSCAN finished. Clusters found (excluding noise): 7
Top ultra luxury clusters (by average price):
   cluster_id  listing_count    avg_price
4           4              3  3468.000000
3           3              3  3376.333333
1           1             16  3215.687500
6           6              4  3177.750000
2           2              3  3074.666667
========================================================================
STEP 4 - NEIGHBORHOOD INVESTMENT SCORES
========================================================================
Top neighborhoods by investment score:
                        investment_score        price  listing_count
neighbourhood_cleansed                                              
Civic Center                        63.9   738.428571              7
Flatiron District                   61.7   566.897959             49
Riverdale                           60.0  1041.500000              2
DUMBO                               59.5   270.615385             13
Tribeca                             56.6   655.933333            105
NoHo                                54.5   541.454545             22
SoHo                                53.4   508.165354            127
Cobble Hill                         53.2   403.045455             22
Battery Park City                   53.0   334.777778             18
Prospect Heights                    52.5   356.582090             67
========================================================================
STEP 5 - MAP CREATION
========================================================================
Added heatmap with 5000 sample listings.
Added 39 premium cluster markers.
Added 10 luxury cluster markers.
Added 7 ultra luxury cluster markers.
Map saved to: maps\nyc_2025-09-01_min200.html
========================================================================
STEP 6 - EXPORTING CSV OUTPUTS
========================================================================
Saved main analyzed data to output\nyc_2025-09-01_min200_analyzed_data.csv
Saved premium clusters to output\nyc_2025-09-01_min200_premium_clusters.csv
Saved luxury clusters to output\nyc_2025-09-01_min200_luxury_clusters.csv
Saved ultra luxury clusters to output\nyc_2025-09-01_min200_ultra_luxury_clusters.csv
Saved neighborhood scores to output\nyc_2025-09-01_min200_neighborhood_scores.csv